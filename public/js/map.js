!function(e){var o={};function s(i){if(o[i])return o[i].exports;var t=o[i]={i:i,l:!1,exports:{}};return e[i].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=o,s.d=function(e,o,i){s.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,o){if(1&o&&(e=s(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var t in e)s.d(i,t,function(o){return e[o]}.bind(null,t));return i},s.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(o,"a",o),o},s.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},s.p="/",s(s.s=1)}({1:function(e,o,s){e.exports=s("mUkR")},mUkR:function(e,o){var s=[],i=[],t=['Thanks to <a href="https://waze.com/pt" >Waze</a> for providing important data and permission to use their services','This site is protected by reCAPTCHA and the Google <a href="https://policies.google.com/privacy">Privacy Policy</a> and <a href="https://policies.google.com/terms">Terms of Service</a> apply'],r={obj:null},a=["gasoline","diesel","lpg","none"],n=["normal","sos","none"];mapboxgl.accessToken="pk.eyJ1Ijoidm9zdHB0IiwiYSI6ImNqeXR3aHQxdTAyYjgzY21wbDMwaHJoaDQifQ.ql-IskzjOdAtEFvbltquaw";var l=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-7.8536599,39.557191],zoom:6,attributionControl:!1});function p(){return new Promise(function(e,o){s=[],$.getJSON("/storage/data/cache.json",function(o){o.forEach(function(e){var o=e.sell_gasoline&&e.has_gasoline,i=e.sell_diesel&&e.has_diesel,t=e.sell_lpg&&e.has_lpg,r=!o&&!i&&!t,a="",n="",l=e.brand;if("SOS"==e.repa)e.repa="sos",a="REPA",2,n="#2f86ca",l+=" (REPA - Veículos Prioritários)";else if("Normal"==e.repa)e.repa="normal",a="REPA",1,n="#2f86ca",l+=" (REPA - Todos os Veículos)";else{var p=0;!o&&e.sell_gasoline||p++,!i&&e.sell_diesel||p++,!t&&e.sell_lpg||p++,3==p?(a="ALL",n="#65ac3d"):0==p?(a="NONE",n="#b32e25"):(a="PARTIAL",n="#f3a433")}s.push({type:"Feature",geometry:{type:"Point",coordinates:[e.long,e.lat]},properties:{id:e.id,name:e.name,brand:l,repa:e.repa,with_gasoline:o,with_diesel:i,with_lpg:t,with_none:r,sell_gasoline:e.sell_gasoline,sell_diesel:e.sell_diesel,sell_lpg:e.sell_lpg,has_gasoline:e.has_gasoline,has_diesel:e.has_diesel,has_lpg:e.has_lpg,icon:a,popup_color:n,priority:0}})}),e()})})}function c(e,o){return new Promise(function(s,i){l.loadImage(o,function(o,t){o?(console.log("ERROR:"+o),i(o)):(console.log("IMAGE LOADED"),l.addImage(e,t),s())})})}function u(){var e=new Date,o=e.getSeconds(),s=e.getMinutes(),i=e.getHours(),r=[].concat(t);return r.push("Última Atualização às: "+("0"+i).slice(-2)+"h"+("0"+s).slice(-2)+"m"+("0"+o).slice(-2)+"s"),r}function d(){i.push(p()),Promise.all(i).then(function(){i=[],n.forEach(function(e){a.forEach(function(o){var s="poi-"+e+"-"+o;l.removeLayer(s)})}),l.removeSource("points"),l.addSource("points",{type:"geojson",data:{type:"FeatureCollection",features:s}}),n.forEach(function(e){var o=e;"none"==o&&(o=""),a.forEach(function(s){var i="poi-"+e+"-"+s;l.addLayer({id:i,type:"symbol",source:"points",layout:{"icon-image":"{icon}","symbol-sort-key":["get","priority"]}}),l.setFilter(i,["all",[">","with_"+s,0],["==","repa",o]])})}),l.removeControl(r.obj),delete r.obj,r.obj=new mapboxgl.AttributionControl({compact:!0,customAttribution:u()}),l.addControl(r.obj),f()})}function f(){var e=$("input.type[type=radio]:checked").val(),o=[],s=$('input[name="fuel_stations_repa[]"]:checked');Object.values(s).forEach(function(e){var s=e.value;s&&o.push(s)}),n.forEach(function(s){a.forEach(function(i){var t="poi-"+s+"-"+i,r=o.includes(s)&&(i==e||"all"==e);l.setLayoutProperty(t,"visibility",r?"visible":"none")})})}String.prototype.capitalize=function(){return this.replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})},l.on("load",function(){i.push(c("REPA","/img/map/VOSTPT_JNDPA_REPA_ICON_25x25.png")),i.push(c("NONE","/img/map/VOSTPT_JNDPA_NONE_ICON_25x25.png")),i.push(c("PARTIAL","/img/map/VOSTPT_JNDPA_PARTIAL_ICON_25x25.png")),i.push(c("ALL","/img/map/VOSTPT_JNDPA_ALL_ICON_25x25.png")),i.push(p()),Promise.all(i).then(function(){i=[],l.addSource("points",{type:"geojson",data:{type:"FeatureCollection",features:s}}),n.forEach(function(e){var o=e;"none"==o&&(o=""),a.forEach(function(s){var i="poi-"+e+"-"+s;l.addLayer({id:i,type:"symbol",source:"points",layout:{"icon-image":"{icon}","symbol-sort-key":["get","priority"]}}),l.setFilter(i,["all",[">","with_"+s,0],["==","repa",o]]),function(e){l.on("click",e,function(e){var o=e.features[0].geometry.coordinates.slice(),s=e.features[0].properties.sell_gasoline&&e.features[0].properties.has_gasoline?'<img src="img/map/VOSTPT_GASPUMP_GASOLINA_500pxX500px.png"/>':'<img class="no-gas"src="img/map/VOSTPT_GASPUMP_GASOLINA_500pxX500px.png"/>',i=e.features[0].properties.sell_diesel&&e.features[0].properties.has_diesel?'<img src="img/map/VOSTPT_GASPUMP_GASOLEO_500pxX500px.png"/>':'<img class="no-gas" src="img/map/VOSTPT_GASPUMP_GASOLEO_500pxX500px.png"/>',t=e.features[0].properties.sell_lpg&&e.features[0].properties.has_lpg?'<img width="75px" src="img/map/VOSTPT_GASPUMP_GPL_500pxX500px.png"/>':'<img class="no-gas" src="img/map/VOSTPT_GASPUMP_GPL_500pxX500px.png"/>',r=e.features[0].properties.name?e.features[0].properties.name.toUpperCase():"",a="",n="",p=0,c="";for(e.features[0].properties.sell_gasoline&&p++,e.features[0].properties.sell_diesel&&p++,e.features[0].properties.sell_lpg&&p++,c=1==p?"col-md-12":2==p?"col-md-6":"col-md-4",isHelping()?(n="",e.features[0].properties.sell_gasoline&&(n+='<div class="'+c+' v-fuel-info gasoline"><a href="#" onclick="swapIcon(this)">'+s+"</a><h6>GASOLINA</h6></div>"),e.features[0].properties.sell_diesel&&(n+='<div class="'+c+' v-fuel-info diesel"><a href="#" onclick="swapIcon(this)">'+i+"</a><h6>GASÓLEO</h6></div>"),e.features[0].properties.sell_lpg&&(n+='<div class="'+c+' v-fuel-info lpg"><a href="#" onclick="swapIcon(this)">'+t+"</a><h6>GPL</h6></div>")):(n="",e.features[0].properties.sell_gasoline&&(n+='<div class="'+c+' v-fuel-info">'+s+"<h6>GASOLINA</h6></div>"),e.features[0].properties.sell_diesel&&(n+='<div class="'+c+' v-fuel-info">'+i+"<h6>GASÓLEO</h6></div>"),e.features[0].properties.sell_lpg&&(n+='<div class="'+c+' v-fuel-info">'+t+"<h6>GPL</h6></div>")),a=isHelping()?'<div class="v-popup-content"><div class="v-popup-header" style="background-color:#6bd7fc"><h5>'+e.features[0].properties.brand.toUpperCase()+"<br><small>"+r+'</small></h5></div><div class="v-popup-body" style="background-color:#afe2fb"><div class="row">'+n+'</div><div class="row"><div class="col-md-12">Por favor indica que combústiveis não estão disponiveis na '+r+'.</div></div><div class="row"><div class="col-md-12">Carrega nas imagens deixando as disponiveis mais nitidas.</div></div></div><div class="v-popup-header" style="background-color:#6bd7fc"><a href="#" onclick="submitEntry(this,'+e.features[0].properties.id+')"><h5>VALIDAR</h5></a></div></div>':'<div class="v-popup-content"><div class="v-popup-header" style="background-color:'+e.features[0].properties.popup_color+'"><h5>'+e.features[0].properties.brand.toUpperCase()+"<br><small>"+r+'</small></h5></div><div class="v-popup-body"><div class="row">'+n+'</div></div><div class="v-popup-header" style="background-color:'+e.features[0].properties.popup_color+'"><h5>OBTER DIREÇÕES</h5></div><div class="v-popup-body directions"><a href="https://www.waze.com/ul?ll='+o[1]+"%2C"+o[0]+'&navigate=yes&zoom=16&download_prompt=false"  target="_blank" rel="noopener noreferrer"><img src="/img/map/map_blur.png"></a></div></div>';Math.abs(e.lngLat.lng-o[0])>180;)o[0]+=e.lngLat.lng>o[0]?360:-360;popup=(new mapboxgl.Popup).setLngLat(o).setHTML(a).addTo(l)}),l.on("mouseenter",e,function(){l.getCanvas().style.cursor="pointer"}),l.on("mouseleave",e,function(){l.getCanvas().style.cursor=""})}(i)})}),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){l.flyTo({center:[e.coords.longitude,e.coords.latitude],zoom:14})}),r.obj=new mapboxgl.AttributionControl({compact:!0,customAttribution:u()}),l.addControl(r.obj),f(),setInterval(d,3e4)})}),l.on("error",function(e){console.log("MAP LOAD ERROR"),console.log(e)}),$("input.type[type=radio]").change(function(){f()}),$("input.repa[type=checkbox]").change(function(){f()})}});